<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>YounghBlog</title><meta name="author" content="Youngh"><meta name="copyright" content="Youngh"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Stay hungry, stay foolish"><meta property="og:type" content="website"><meta property="og:title" content="YounghBlog"><meta property="og:url" content="https://younghblog.gitee.io/index.html"><meta property="og:site_name" content="YounghBlog"><meta property="og:description" content="Stay hungry, stay foolish"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://img.gejiba.com/images/3cb1dc95c490420f129fb73888c41e12.md.webp"><meta property="article:author" content="Youngh"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://img.gejiba.com/images/3cb1dc95c490420f129fb73888c41e12.md.webp"><link rel="shortcut icon" href="https://cdn1.tianli0.top/gh/exploreMeta/cdn/img/logo/favicon.ico"><link rel="canonical" href="https://younghblog.gitee.io/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="stylesheet" href="https://jokerdig.com/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.0.0/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:300},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn1.tianli0.top/npm/flickr-justified-gallery@2/dist/fjGallery.min.js",css:"https://cdn1.tianli0.top/npm/flickr-justified-gallery@2/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"YounghBlog",isPost:!1,isHome:!0,isHighlightShrink:!1,isToc:!1,postUpdate:"2022-10-29 15:11:37"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,a){if(0!==a){a*=864e5,t={value:t,expiry:(new Date).getTime()+a},localStorage.setItem(e,JSON.stringify(t))}},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);if(!((new Date).getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=e=>new Promise((t,a)=>{const o=document.createElement("script");o.src=e,o.async=!0,o.onerror=a,o.onload=o.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(o.onload=o.onreadystatechange=null,t())},document.head.appendChild(o)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")},"dark"===(e=saveToLocal.get("theme"))?activateDarkMode():"light"===e&&activateLightMode(),void 0!==(e=saveToLocal.get("aside-status"))&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside")),/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="https://cdn1.tianli0.top/gh/exploreMeta/cdn/css/index.min.css"><link rel="stylesheet" href="https://jokerdig.com/css/index.css"><link rel="stylesheet" href="https://cdn1.tianli0.top/gh/exploreMeta/cdn/css/haa.css"><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/rss2.xml" title="YounghBlog" type="application/rss+xml"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/3cb1dc95c490420f129fb73888c41e12.md.webp" onerror='onerror=null,src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">YounghBlog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">YounghBlog</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="tencent://AddContact/?fromId=50&amp;fromSubId=1&amp;subcmd=all&amp;uin=1413483899" target="_blank"><i class="fa-brands fa-qq"></i></a><a class="social-icon" href="mailto:1413483899@qq.com" target="_blank"><i class="fa-solid fa-envelope"></i></a><a class="social-icon" href="/rss2.xml" target="_blank"><i class="fa-solid fa-rss"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/posts/1916506233.html" title="Android画面显示流程"><img class="post_bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/02444853758d96ea1ce979fcd95b7973.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="Android画面显示流程"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/1916506233.html" title="Android画面显示流程">Android画面显示流程</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-10-08T15:44:58.000Z" title="发表于 2022-10-08 23:44:58">2022-10-08</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-10-08T16:10:13.152Z" title="更新于 2022-10-09 00:10:13">2022-10-09</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android%E5%9F%BA%E7%A1%80/">Android基础</a></span></div><div class="content">本文将会介绍从 App 画出一帧画面到这帧画面被传送到屏幕进行显示的整个过程。这其中会涉及到一些硬件的基础知识，但这些硬件并不是本文关注的重点，介绍它们主要是为了跟软件层面关联起来，以便对 Android 的显示流程形成一个完整的认知体系。 先来简单介绍一下本文所涉及的硬件以及内核层中的几个概念。 预备知识 ION：Android 流行的内存管理机制，处在内核空间。 DRM：Direct Rendering Manager，直接渲染管理器，也在内核空间。提供了一组 API，用户空间程序可以通过它发送画面数据到 GPU，也可以使用它执行诸如配置分辨率、刷新率之类的设置操作。目前在高通平台手机 Android 系统上的显示系统也是使用的这组 API 来完成画面的渲染更新。 一个典型的 Android 显示系统一般包括以下三个部分： SOC：负责绘画与多图层的合成，把合成好的数据传输给 DDIC。 DDIC：负责把 Buffer 里的数据写到 GRAM（显示存储器）中。 Panel：不断扫描 GRAM 以显示内容。 用户空间的帧数据流 应用要绘制一个画面，首先要向 SurfaceFl ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/2031896266.html" title="Binder机制"><img class="post_bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/3d23f7fc9501aa22402a02666b09e892.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="Binder机制"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/2031896266.html" title="Binder机制">Binder机制</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-09-25T01:08:18.000Z" title="发表于 2022-09-25 09:08:18">2022-09-25</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-09-25T01:31:52.081Z" title="更新于 2022-09-25 09:31:52">2022-09-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android%E5%9F%BA%E7%A1%80/">Android基础</a></span></div><div class="content">Binder 是 Android 提供的跨进程通信机制。Android 系统是基于 Linux 内核的，Linux 已经拥有 FIFO、管道、信号，到后来的信号量、消息队列、共享内存，再到 eventfd、mmap 内存映射、Socket 等等，但是 Android 却采用了 Binder 这种不同上述几种类型的特有机制，原因有很多，比如性能优化、安全、可扩展性等等。 Binder的优势 性能优化 在传统的Linux IPC方式中： socket 作为一款通用接口，其传输效率低、开销大，主要用在跨网络的进程间通信和本机上进程间的低速通信。 消息队列和管道采用存储-转发方式，即数据先从发送方缓存区拷贝到内核开辟的缓存区中，然后再从内核缓存区拷贝到接收方缓存区，至少有两次拷贝过程。 共享内存虽然无需拷贝，但控制复杂，难以使用。 例如，Client 要将一块内存数据传递给 Server，一般的做法是，Client 将这块数据从它的进程空间拷贝到内核空间中，然后内核再将这个数据从内核空间拷贝到 Server 的进程空间，这样，Server 就可以访问这个数据了。但是在这种方 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/2872386792.html" title="JNI学习"><img class="post_bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/788496e432e69da44ecda3baa70659f5.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="JNI学习"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/2872386792.html" title="JNI学习">JNI学习</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-09-21T15:15:22.000Z" title="发表于 2022-09-21 23:15:22">2022-09-21</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-09-25T01:32:23.248Z" title="更新于 2022-09-25 09:32:23">2022-09-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android%E5%9F%BA%E7%A1%80/">Android基础</a></span></div><div class="content">JNI的作用 JNI 是 Java Native Interface（Java 本地接口）的缩写，能使 Java 和 Native 实现互调。 Android 作为一种嵌入式系统，有大量跟驱动、硬件相关的功能必须在 Native 层实现，还有一些注重性能、功耗的功能使用 Native 实现也要优于 Java。在 Android 中，Java 主要负责 UI 功能的实现，而 Native 则完成一些复杂的算法以及与底层交互的，因此二者的交互特别频繁，JNI 的重要性不言而喻。 Java 的执行离不开虚拟机，因此当需要在 Java 中调用 Native 层函数时，需要告诉虚拟机哪个方法代表 Native 函数，以及在哪里能找到这个函数，反之亦然。二者之间的区别是： 从 Java 到 Native 建立的是函数关联。 从 Native 到 Java 必须先得到 Java 对象的引用，才能调用该对象的方法。 需要注意的是，二者之间的交互并没有跨线程调用，它们都在同一个线程中运行。但它们打印出的线程 ID 值是不同的，这仅仅是因为二者所使用的线程 ID 的表示方法不同。 Dalvik ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/3659942439.html" title="Android渲染的整体架构"><img class="post_bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/eb8d19563d07ccc303ce96f0da4a25af.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="Android渲染的整体架构"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/3659942439.html" title="Android渲染的整体架构">Android渲染的整体架构</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-09-04T13:11:29.000Z" title="发表于 2022-09-04 21:11:29">2022-09-04</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-09-06T15:16:03.544Z" title="更新于 2022-09-06 23:16:03">2022-09-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android%E4%B9%8B%E6%98%BE%E7%A4%BA%E6%9C%8D%E5%8A%A1/">Android之显示服务</a></span></div><div class="content">概述 Android 渲染的整体架构是一个生产者-消费者模型： 当用户程序刷新 UI 时，会从 从 BufferQueue 中 dequeue 一个空的 Buffer，然后把 UI 信息填入，再 queue 到 BufferQueue 中。SurfaceFlinger 从 BufferQueue 中 acquire 绘制好的 Buffer 并 release 掉空的 Buffer，然后请求 HWC 进行图像合成，最终送到显示器上进行显示。 常见的图像生产者： OpenGL： Open Graphics Library，一种跨平台的 3D 绘图规范接口。 OpenGL ES： OpenGL for Embedded Systems，OpenGL 的子集，能够绘制 纹理。 纹理即物体表面的样子。在计算机世界中，只通过几何图形并不能很好地展示现实中的物体，因此我们通常会通过纹理映射的方式将物体表面的图片贴到几何图形上面，从而更好地模拟现实世界。纹理可以理解为物体表面的图片。 Skia： 一种跨平台的 2D 绘图规范接口。 Vulkan： 一种跨平台的 2D 和 3D ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/1441608745.html" title="「高效能人士的七个习惯」读书笔记"><img class="post_bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/b60a19efb0970a66b87460015b04961c.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="「高效能人士的七个习惯」读书笔记"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/1441608745.html" title="「高效能人士的七个习惯」读书笔记">「高效能人士的七个习惯」读书笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-08T12:39:21.000Z" title="发表于 2022-07-08 20:39:21">2022-07-08</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-09T14:45:28.649Z" title="更新于 2022-07-09 22:45:28">2022-07-09</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E6%88%90%E9%95%BF/">读书笔记 - 成长</a></span></div><div class="content">人的行为总是一再重复。因此卓越不是一时的行为，而是习惯。 —— 亚里士多德&nbsp;&nbsp;&nbsp;&nbsp; 习惯对我们的生活有极大的影响，选择什么样的习惯，也就决定了过什么样的生活。 但改变习惯绝非易事，就像宇宙飞船必须摆脱强大的地心引力一样，起飞需要巨大的努力，而一旦摆脱了引力的束缚，就会迎来广阔自由的天地。 本书正是教我们通过改变思维方式，由内而外地实现个人效能和人际效能。这里的效能作为衡量人生的单位，是指产出与产能的比值，其关键在于二者的平衡。书中介绍的七个习惯，能够帮助我们依次经历从依赖到独立，再从独立到互赖的成熟模式。 接下来我将简单整理一下这七个习惯： 个人领域的成功 从依赖走向独立，实现个人领域的成功。 习惯一：积极主动 在外界的刺激和我们的回应之间，还存在选择的自由，这就是高效能人士在任何环境中都应具备的最基本的习惯——积极主动。 积极主动是要为自己过去、现在及未来的行为负责，依据原则和价值观，而非情绪或外在环境来做决定。 “除非你愿意，否则没人能伤害你。”说的就是这个道理。 习惯二：以终为始 以终为始的一个原则基础是：任何事情都要经过两次创造 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/1980352382.html" title="「关键对话」读书笔记"><img class="post_bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/e23ded29a0c8c46be41bcbaf31ecec1f.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="「关键对话」读书笔记"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/1980352382.html" title="「关键对话」读书笔记">「关键对话」读书笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-01T14:42:30.000Z" title="发表于 2022-07-01 22:42:30">2022-07-01</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-10T00:26:25.400Z" title="更新于 2022-07-10 08:26:25">2022-07-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E6%88%90%E9%95%BF/">读书笔记 - 成长</a></span></div><div class="content">这绝对称得上是一本宝藏书籍！ 书中通过翔实的研究和大量生动有趣的案例，详细介绍了掌握关键对话的方法，旨在帮助我们在对话中创建正确的心理和情绪状态，合理利用恰当的技巧模式。 人生中有很多大大小小的岔路口，我们的每一次选择都将改变之后的人生走向。从这个意义上来说，「关键对话」正是一部为我们提供关键指引、能够有效改变人生轨迹的伟大作品。 接下来我将简单梳理一下本书的主要脉络，对书中精华做一个整理归纳。 何谓关键对话 关键对话是指那些双方观点迥异、内容充满风险、情绪非常激烈的对话。这类对话之所以关键，是因为其结果会对我们的生活质量产生巨大的影响。 通常来说，对话内容越关键，我们能够正确处理问题的能力就越差。因为当我们情绪非常激动时，体内会释放大量肾上腺素，受此激素的影响，血液会从其他器官抽离，充斥到我们的四肢，以便做好战斗或逃跑的准备，而脑部负责思维的部分则因缺血导致无法正常思考。 那么，我们该如何处理关键对话呢？ 掌握关键对话 掌握关键对话的思路大致可以分为以下四个步骤： 摆脱傻瓜式选择 傻瓜式选择有两种：一种是隐忍不发，一种是冲冠一怒。前者会任由情况向不利的方向发展，后者则容易说出让 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/3530858630.html" title="类图关系"><img class="post_bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/b7b2bff1536fac218aae9798f503a825.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="类图关系"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/3530858630.html" title="类图关系">类图关系</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-06-26T07:07:31.000Z" title="发表于 2022-06-26 15:07:31">2022-06-26</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-05T09:32:14.239Z" title="更新于 2022-07-05 17:32:14">2022-07-05</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%85%B6%E5%AE%83/">其它</a></span></div><div class="content">类图关系示例</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/1155868944.html" title="库与运行库"><img class="post_bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/ed0f3f7a012e4718162c75786caa867b.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="库与运行库"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/1155868944.html" title="库与运行库">库与运行库</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-06-22T12:35:28.000Z" title="发表于 2022-06-22 20:35:28">2022-06-22</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-05T09:33:18.497Z" title="更新于 2022-07-05 17:33:18">2022-07-05</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/">读书笔记 - 程序员的自我修养</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%A0%86%E7%AE%A1%E7%90%86/">堆管理</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/">系统调用</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E4%B8%AD%E6%96%AD/">中断</a></span></div><div class="content">函数返回值传递 之前在 CSAPP 中介绍过函数传参时的栈帧结构，并且假设返回值都是通过 rax 寄存器传递的。对于 32 位的系统，则是通过 eax 寄存器传递的，但 eax 本身只有 4 个字节，对于返回 5 ~ 8 字节的情况，几乎所有的调用惯例都是通过 eax 与 edx 联合返回的方式进行的。那对于超过 8 个字节的返回类型又该如何传递呢？ 1234567891011121314typedef struct big_obj &#123; char buf[128];&#125; big_obj;big_obj return_test() &#123; big_obj obj; obj.buf[0] = 0; return obj;&#125;int main() &#123; big_obj res = return_test(); return 0;&#125; 这段代码中 return_test 的返回类型是一个长度为 128 字节的结构，它的传递方式如下： main() 函数在栈上额外开辟一块空间，将其中一部分作为传递返回值的临时 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/3697966026.html" title="装载与动态链接"><img class="post_bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/ed0f3f7a012e4718162c75786caa867b.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="装载与动态链接"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/3697966026.html" title="装载与动态链接">装载与动态链接</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-06-14T07:45:02.000Z" title="发表于 2022-06-14 15:45:02">2022-06-14</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-05T09:33:39.222Z" title="更新于 2022-07-05 17:33:39">2022-07-05</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/">读书笔记 - 程序员的自我修养</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%A3%85%E8%BD%BD/">装载</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/">动态链接</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/PIC/">PIC</a></span></div><div class="content">在 上一篇 文章中，通过静态链接我们已经得到了可执行文件。为了使其运行起来，还需要将其读取到物理内存中才能被 CPU 执行。这篇文章就重点介绍一下可执行文件是如何被装载到物理内存的，以及动态链接的过程。 装载 当 ELF 可执行文件要被执行时，系统会先建立一个进程，具体过程如下： 创建一个独立的虚拟地址空间。实际上只是创建虚拟地址空间与物理地址空间映射时所需的数据结构，而具体的映射关系则会推迟到发生页错误时才进行设置。 读取可执行文件头，建立虚拟空间与可执行文件的映射关系。这一步的目的是为了知道在发生缺页时该加载 可执行文件（又叫 映像文件）的哪个页到物理内存。 将指令寄存器设置成可执行文件的入口地址。该地址也记录在可执行文件头中。 以上步骤执行完后实际上只是建立起了可执行文件与进程虚拟内存空间的映射关系，程序的指令和数据都还没被装入到内存。当 CPU 开始执行该程序时就会发生缺页异常，这时才会处理缺页。具体过程如下： 根据上述建立的映射关系，计算出所缺页在可执行文件中的偏移。 在物理内存中分配一个物理页，并将所缺页从磁盘读入该物理页。 建立虚拟页与物理页的映射关系，然后重新执 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/1093737480.html" title="静态链接"><img class="post_bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/ed0f3f7a012e4718162c75786caa867b.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="静态链接"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/1093737480.html" title="静态链接">静态链接</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-06-03T07:56:36.000Z" title="发表于 2022-06-03 15:56:36">2022-06-03</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-05T09:33:55.257Z" title="更新于 2022-07-05 17:33:55">2022-07-05</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/">读书笔记 - 程序员的自我修养</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E9%9D%99%E6%80%81%E9%93%BE%E6%8E%A5/">静态链接</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/ELF/">ELF</a></span></div><div class="content">粽 有 千 古 ， 横 有 八 荒前 途 似 海 ， 来 日 方 长—— 今日端午，祝各位端午安康❤️ 本文对应原书的第 2 部分，主要介绍了目标文件的格式和静态链接的详细过程。这里我以原书中的示例代码作为切入点进行介绍。 首先厘清几个概念，方便对文章的理解。 基本概念 编译生成的 .o 文件叫做可重定位目标文件，或者 目标文件，也叫 模块。 链接器 所做的工作，无非就是把指令中对其他符号地址的引用加以修正。地址修正的过程就是 重定位，每个需要被修正的地方都是一个 重定位入口（Relocation Entry）。 符号决议，其实就是地址绑定。只不过 决议 更倾向于静态链接，绑定 则倾向于动态链接。 目标文件（relocatable）就是按照可执行文件的格式存储的，只是因为还没有链接，可能有些符号或地址尚未被调整。Linux 的可执行文件格式是 ELF（Executable Linkable Format），ELF 的文件类型包括可重定位（relocatable）文件、可执行（executable）文件、共享目标（shared object）文件以及核心转储文件（cor ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/3cb1dc95c490420f129fb73888c41e12.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="avatar"></div><div class="author-info__name">Youngh</div><div class="author-info__description">Stay hungry, stay foolish</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://gitee.com/younghblog"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="tencent://AddContact/?fromId=50&amp;fromSubId=1&amp;subcmd=all&amp;uin=1413483899" target="_blank"><i class="fa-brands fa-qq"></i></a><a class="social-icon" href="mailto:1413483899@qq.com" target="_blank"><i class="fa-solid fa-envelope"></i></a><a class="social-icon" href="/rss2.xml" target="_blank"><i class="fa-solid fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>O.O</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/1916506233.html" title="Android画面显示流程"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/02444853758d96ea1ce979fcd95b7973.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="Android画面显示流程"></a><div class="content"><a class="title" href="/posts/1916506233.html" title="Android画面显示流程">Android画面显示流程</a><time datetime="2022-10-08T15:44:58.000Z" title="发表于 2022-10-08 23:44:58">2022-10-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2031896266.html" title="Binder机制"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/3d23f7fc9501aa22402a02666b09e892.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="Binder机制"></a><div class="content"><a class="title" href="/posts/2031896266.html" title="Binder机制">Binder机制</a><time datetime="2022-09-25T01:08:18.000Z" title="发表于 2022-09-25 09:08:18">2022-09-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2872386792.html" title="JNI学习"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/788496e432e69da44ecda3baa70659f5.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="JNI学习"></a><div class="content"><a class="title" href="/posts/2872386792.html" title="JNI学习">JNI学习</a><time datetime="2022-09-21T15:15:22.000Z" title="发表于 2022-09-21 23:15:22">2022-09-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/3659942439.html" title="Android渲染的整体架构"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/eb8d19563d07ccc303ce96f0da4a25af.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="Android渲染的整体架构"></a><div class="content"><a class="title" href="/posts/3659942439.html" title="Android渲染的整体架构">Android渲染的整体架构</a><time datetime="2022-09-04T13:11:29.000Z" title="发表于 2022-09-04 21:11:29">2022-09-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1441608745.html" title="「高效能人士的七个习惯」读书笔记"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.gejiba.com/images/b60a19efb0970a66b87460015b04961c.md.webp" onerror='this.onerror=null,this.src="https://img.gejiba.com/images/4f60b4e053a96873d937752732c06a09.gif"' alt="「高效能人士的七个习惯」读书笔记"></a><div class="content"><a class="title" href="/posts/1441608745.html" title="「高效能人士的七个习惯」读书笔记">「高效能人士的七个习惯」读书笔记</a><time datetime="2022-07-08T12:39:21.000Z" title="发表于 2022-07-08 20:39:21">2022-07-08</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline"><i class="fas fa-folder-open"></i> <span>分类</span></div><ul class="card-category-list" id="aside-cat-list"><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/Android%E4%B9%8B%E6%98%BE%E7%A4%BA%E6%9C%8D%E5%8A%A1/"><span class="card-category-list-name">Android之显示服务</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/Android%E5%9F%BA%E7%A1%80/"><span class="card-category-list-name">Android基础</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/%E5%85%B6%E5%AE%83/"><span class="card-category-list-name">其它</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-CSAPP/"><span class="card-category-list-name">读书笔记 - CSAPP</span><span class="card-category-list-count">7</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E6%88%90%E9%95%BF/"><span class="card-category-list-name">读书笔记 - 成长</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/"><span class="card-category-list-name">读书笔记 - 程序员的自我修养</span><span class="card-category-list-count">4</span></a></li></ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/%E6%B1%87%E7%BC%96/" style="font-size:1.15em;color:#0e532c">汇编</a><a href="/tags/%E6%A0%88%E5%B8%A7/" style="font-size:1.15em;color:#61b132">栈帧</a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%AF%B9%E9%BD%90/" style="font-size:1.15em;color:#8f3e60">数据对齐</a><a href="/tags/%E5%A0%86%E7%AE%A1%E7%90%86/" style="font-size:1.15em;color:#5048a9">堆管理</a><a href="/tags/%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/" style="font-size:1.15em;color:#324597">系统调用</a><a href="/tags/%E4%B8%AD%E6%96%AD/" style="font-size:1.15em;color:#2fb15c">中断</a><a href="/tags/CPU%E6%B5%81%E6%B0%B4%E7%BA%BF/" style="font-size:1.15em;color:#9602b7">CPU流水线</a><a href="/tags/%E5%88%86%E6%94%AF%E6%B6%88%E9%99%A4/" style="font-size:1.15em;color:#5100ae">分支消除</a><a href="/tags/MESI/" style="font-size:1.15em;color:#086ca2">MESI</a><a href="/tags/cache/" style="font-size:1.15em;color:#a060b9">cache</a><a href="/tags/%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/" style="font-size:1.15em;color:#3f73a7">虚拟内存</a><a href="/tags/%E5%9C%B0%E5%9D%80%E7%BF%BB%E8%AF%91/" style="font-size:1.15em;color:#8eb947">地址翻译</a><a href="/tags/%E7%BA%BF%E7%A8%8B/" style="font-size:1.15em;color:#7979bc">线程</a><a href="/tags/%E9%9D%99%E6%80%81%E9%93%BE%E6%8E%A5/" style="font-size:1.15em;color:#c65d24">静态链接</a><a href="/tags/ELF/" style="font-size:1.15em;color:#7d3e38">ELF</a><a href="/tags/%E8%A3%85%E8%BD%BD/" style="font-size:1.15em;color:#c05dc8">装载</a><a href="/tags/%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/" style="font-size:1.15em;color:#a9359b">动态链接</a><a href="/tags/PIC/" style="font-size:1.15em;color:#221273">PIC</a></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">19</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">61.3k</div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastpushdate="2022-10-29T07:11:36.946Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022&nbsp;&nbsp;&nbsp;<i style="color:#ff6a6a;animation:announ_animation .8s linear infinite" class="fas fa-heart"></i>&nbsp;&nbsp;&nbsp;By Youngh</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="https://www.antmoe.com/js/utils.js"></script><script src="https://www.antmoe.com/js/main.js"></script><script src="https://cdn1.tianli0.top/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.staticfile.org/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://cdn.staticfile.org/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="https://www.antmoe.com/js/search/local-search.js" defer></script><div class="js-pjax"><script>function subtitleType(){window.typed=new Typed("#subtitle",{strings:["欢迎来到我的世界！","Welcome to my world！"],startDelay:300,typeSpeed:150,loop:!0,backSpeed:50})}"function"==typeof Typed?subtitleType():getScript("https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/typed.js/2.0.12/typed.min.js").then(subtitleType)</script></div><script src="https://cdn1.tianli0.top/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script id="click-heart" src="https://cdn1.tianli0.top/npm/butterfly-extsrc@1/dist/click-heart.min.js" async mobile="false"></script><script src="https://cdn.casecori.top/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.tocScrollFn&&window.removeEventListener("scroll",window.tocScrollFn),window.scrollCollect&&window.removeEventListener("scroll",scrollCollect),"object"==typeof preloader&&preloader.initLoading(),document.getElementById("rightside").style.cssText="opacity: ''; transform: ''",window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script");var o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()})),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script></div></body></html>